from pynput import clipboard
import websocket
import json
import time

class ClipboardMonitor:
    def __init__(self, ws_url):
        self.ws_url = ws_url
        self.previous_clipboard_content = ""

    def on_clipboard_change(self):
        current_clipboard_content = clipboard.paste()
        if current_clipboard_content != self.previous_clipboard_content:
            self.previous_clipboard_content = current_clipboard_content
            self.send_clipboard_content(current_clipboard_content)

    def send_clipboard_content(self, content):
        try:
            ws = websocket.create_connection(self.ws_url)
            message = json.dumps({"clipboard": content})
            ws.send(message)
            ws.close()
        except Exception as e:
            print(f"Error sending clipboard content: {e}")

    def start_monitoring(self):
        while True:
            self.on_clipboard_change()
            time.sleep(1)  # Check clipboard every second

if __name__ == "__main__":
    ws_url = "ws://localhost:5000"  # Update with your WebSocket server URL
    monitor = ClipboardMonitor(ws_url)
    monitor.start_monitoring()